superset:
  replicaCount: 2

  service:
    type: ClusterIP
    port: 8088

  resources:
    limits:
      cpu: 1
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi

  externalDatabase:
    type: postgresql
    host: postgresql
    port: 5432
    user: superset
    password: supersetpassword
    database: superset_db

  externalRedis:
    host: redis
    port: 6379
    password: 'admin'
  
  configOverrides:
    secret: |
      import os
      SECRET_KEY = os.getenv("SUPERSET_SECRET_KEY")

  extraSecretEnv:
    - name: SUPERSET_SECRET_KEY
      secretName: superset-secret-key
      secretKey: SUPERSET_SECRET_KEY

  ingress:
    enabled: true
    ingressClassName: "external-nginx"
    # Extend timeout to allow long running queries.
    annotations: {
      "cert-manager.io/issuer": "superset-ui",
      "acme.cert-manager.io/http01-edit-in-place": "true",
      "nginx.ingress.kubernetes.io/proxy-connect-timeout": "300",
      "nginx.ingress.kubernetes.io/proxy-read-timeout": "300",
      "nginx.ingress.kubernetes.io/proxy-send-timeout": "300",
    }
    path: /
    pathType: ImplementationSpecific
    hosts:
      - ipea-superset.lappis.rocks
    tls:
    - secretName: ingress-superset-ui
      hosts:
        - ipea-superset.lappis.rocks

  postgresql:
    enabled: true

  redis:
    enabled: true
